.contact-box
    .sms-box
        a(href="sms:" + phone.content)
            img.icon(src="http://file.baixing.net/202011/c51a85711ff66afd018933dc40f327d0.png")
            span 短信
        .line
    .wechat-box
        a(href="javascript:testApp('weixin://')" class="dl-btn" id="download")
            img.icon(src="//file.baixing.net/202011/1169b4da5402928ab52fa35fc0cfa925.png")
            span 微信
        .line
    .phone-box
        a(href="tel:" + phone.content )
            img.tel-icon(src="http://file.baixing.net/202011/fe2ad24adc586625082cf7bd202a922e.png")
            .info
                p 拨打电话
                p #{ phone.content }

block append scripts
    script.
        function testApp(url) {
            var timeout, t = 1000, hasApp = true;
            setTimeout(function () {
                if (!hasApp) {
                    //没有安装微信
                    var r=confirm("您没有安装微信，请先安装微信!");
                    if (r==true){
                        location.href="http://weixin.qq.com/"
                    }
                }else{
                    //安装微信
                }
                document.body.removeChild(ifr);
            }, 2000)

            var t1 = Date.now();
            var ifr = document.createElement("iframe");
            ifr.setAttribute('src', url);
            ifr.setAttribute('style', 'display:none');
            document.body.appendChild(ifr);
            timeout = setTimeout(function () {
                var t2 = Date.now();
                if (!t1 || t2 - t1 < t + 100) {
                hasApp = false;
                }
            }, t);
            }
